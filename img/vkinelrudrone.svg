<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg
   xmlns:dc="http://purl.org/dc/elements/1.1/"
   xmlns:cc="http://creativecommons.org/ns#"
   xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
   xmlns:svg="http://www.w3.org/2000/svg"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:xlink="http://www.w3.org/1999/xlink"
   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
   width="229.85072mm"
   height="148.50945mm"
   viewBox="0 0 526.34441 340.07775"
   version="1.1"
   id="svg20"
   sodipodi:docname="vkinelrudrone.svg"
   inkscape:version="1.0.2 (e86c870879, 2021-01-15)">
  <defs
     id="defs13" />
  <title
     id="title214">Схема VKinel.ru</title>
  <sodipodi:namedview
     id="base"
     pagecolor="#ffffff"
     bordercolor="#666666"
     borderopacity="1.0"
     inkscape:pageopacity="0.0"
     inkscape:pageshadow="2"
     inkscape:zoom="2.4697145"
     inkscape:cx="508.1961"
     inkscape:cy="392.73631"
     inkscape:document-units="px"
     inkscape:current-layer="g858"
     inkscape:document-rotation="0"
     showgrid="false"
     inkscape:window-width="1718"
     inkscape:window-height="1078"
     inkscape:window-x="200"
     inkscape:window-y="0"
     inkscape:window-maximized="0"
     fit-margin-top="0"
     fit-margin-left="0"
     fit-margin-right="0"
     fit-margin-bottom="0"
     lock-margins="true"
     scale-x="0.10001"
     viewbox-width="526"
     units="mm"
     inkscape:showpageshadow="false"
     showborder="false" />
  <metadata
     id="metadata17">
    <rdf:RDF>
      <cc:Work
         rdf:about="">
        <dc:format>image/svg+xml</dc:format>
        <dc:type
           rdf:resource="http://purl.org/dc/dcmitype/StillImage" />
        <dc:title>VKinel.ru</dc:title>
        <dc:creator>
          <cc:Agent>
            <dc:title>VKinelru</dc:title>
          </cc:Agent>
        </dc:creator>
        <dc:rights>
          <cc:Agent>
            <dc:title>ВКинельРу</dc:title>
          </cc:Agent>
        </dc:rights>
        <dc:publisher>
          <cc:Agent>
            <dc:title>ВКинель.Ру</dc:title>
          </cc:Agent>
        </dc:publisher>
        <dc:identifier>ВКинельРу</dc:identifier>
        <dc:source>ВКинель.Ру</dc:source>
        <dc:date>2025</dc:date>
      </cc:Work>
    </rdf:RDF>
  </metadata>
  <g
     inkscape:label="Layer 1"
     inkscape:groupmode="layer"
     id="layer1"
     style="display:inline">
    <image
       width="526.34442"
       height="340.07776"
       style="display:inline;opacity:1"
       xlink:href="https://vkinelru.github.io/3d/img/kupi.VKinel.ru-doma-i-horizont-full-remaker_ai.jpeg"
       id="jpegback"
       x="0"
       y="0"
       inkscape:svg-dpi="1"
       sodipodi:insensitive="true" />
    <path
       style="display:inline;fill:none;stroke:#000000;stroke-width:0.60588px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
       d="M 0,0 V 340.07776 H 526.34442 V 0 Z"
       id="Граница_карты" />
    <g
       id="g858"
       transform="matrix(1.0734592,0,0,1.1365767,-1.9117085,-26.026819)">
      <path
         style="fill:none;stroke:#000000;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:3.57125, 0.595209;stroke-dashoffset:0;stroke-opacity:1"
         d="m 323.57705,202.81297 6.93672,42.54588 -23.08231,46.14549 -111.78475,-23.82807 48.78634,-49.67896 40.18856,-23.97396 z"
         id="Вся_территория_VKinelru" />
      <path
         style="fill:none;stroke:#ff0000;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
         d="m 278.95685,256.01368 -0.94883,2.8925 -3.47949,-0.72356 -1.33809,4.77345 2.56882,0.60366 -4.78316,10.96925 28.99789,5.63136 0.97724,-3.84873 8.11085,1.73511 1.91014,-6.51098 -6.36418,-1.01194 1.97997,-0.40601 0.63114,-2.64275 -2.8728,-1.27439 3.75479,-0.42263 0.42485,-2.44958 -2.60603,-1.22001 0.12435,-0.30427 z"
         id="Сингапур"
         sodipodi:nodetypes="ccccccccccccccccccc" />
      <path
         style="fill:none;stroke:#0000ff;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
         d="m 262.50997,219.10165 -8.31989,17.29125 19.14557,4.44776 -1.11298,2.22695 10.45723,2.39865 0.9118,-2.21105 3.2262,0.74953 6.11169,-18.87487 z"
         id="Валенсия"
         sodipodi:nodetypes="ccccccccc" />
      <path
         style="fill:none;stroke:#ff0000;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
         d="m 295.6799,216.61703 -2.28125,5.91404 -25.1702,-4.74533 1.84188,-6.16034 z"
         id="Баня"
         sodipodi:nodetypes="ccccc" />
      <path
         style="fill:none;stroke:#00ff00;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
         d="m 314.95428,227.28939 -1.75289,16.85339 -5.47579,-0.79658 -3.40635,3.88636 -16.75395,-3.07728 7.06619,-20.68084 2.54803,0.40933 0.49586,-1.91496 5.26003,0.99853 -0.3787,2.02439 z"
         id="Ливерпуль"
         sodipodi:nodetypes="ccccccccccc" />
      <path
         style="fill:none;stroke:#ffff00;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
         d="m 244.13407,239.27431 -8.6938,13.59127 10.68627,2.87262 7.46853,-13.79721 z"
         id="Газифицированный_дом"
         sodipodi:nodetypes="ccccc" />
      <path
         style="fill:none;stroke:#f90000;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:3.57125, 0.595209;stroke-dashoffset:0;stroke-opacity:1"
         d="m 324.33508,260.31053 -49.74233,-11.42498 -4.81181,7.53931 -14.04322,-2.95726 -15.54096,24.46952 67.86272,14.33209 z"
         id="Сингапур_территория"
         sodipodi:nodetypes="ccccccc" />
      <path
         style="fill:none;stroke:#00f900;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:2.16375, 0.360624;stroke-dashoffset:0;stroke-opacity:1"
         d="m 324.54689,202.39152 7.29031,42.9286 -4.73226,9.8056 -40.05635,-8.6684 7.5829,-22.98287 1.13417,-1.17848 2.90451,-1.77287 2.72207,-8.3046 3.35538,-14.38358 z"
         id="Ливерпуль_территория"
         sodipodi:nodetypes="cccccccccc" />
      <path
         style="fill:none;stroke:#ffff00;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:3.57125, 0.595209;stroke-dashoffset:0;stroke-opacity:1"
         d="m 251.26657,249.52747 4.34321,-7.81832 -10.29148,-3.07899 -17.56741,-5.00405 -33.91636,34.38872 45.61937,9.77253 15.84585,-24.8718 13.984,2.92977 4.79723,-7.55673 50.37746,11.51006 1.05765,-1.90476 -52.73246,-11.62576 -4.78459,7.92902 -11.68157,-3.27096 z"
         id="Газифицированный_дом_территория"
         sodipodi:nodetypes="ccccccccccccccc" />
      <path
         style="fill:none;stroke:#ff0000;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:3.57125, 0.595209;stroke-dashoffset:0;stroke-opacity:1"
         d="m 284.20804,193.36732 -36.74441,21.87386 43.9981,8.78661 6.17273,-4.01204 3.3013,-8.73907 3.04102,-13.61644 z"
         id="Баня_территория"
         sodipodi:nodetypes="ccccccc" />
      <path
         style="fill:none;stroke:#0000f8;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:2.16375, 0.360624;stroke-dashoffset:0;stroke-opacity:1"
         d="m 246.82078,215.5847 46.28153,9.06657 -7.20338,22.12047 41.12498,8.6017 -1.2124,2.14112 -38.65647,-8.42965 -7.80757,-1.81026 -7.12495,-1.58525 -4.62927,7.82072 -15.39333,-4.16202 4.36335,-7.8497 -10.70898,-3.29128 -17.74189,-4.98183 15.40736,-15.71534 z"
         id="Валенсия_территория"
         sodipodi:nodetypes="ccccccccccccccc" />
    </g>
    <path
       style="fill:none;stroke:#000000;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:0.27898872;stroke-width:0.60588001;stroke-miterlimit:4;stroke-dasharray:0.60588001, 4.84704005000000038;stroke-dashoffset:0"
       d="m 126.48162,312.21454 -105.845754,-0.0339 0.02417,-105.8097 105.717544,0.0249 z"
       id="Kvadrat" />
  </g>
  <style
     type="text/css"
     id="style"><![CDATA[
svg {
width:100%;
height:100%;
margin: 0 !important;
padding: 0 !important;
border: 0 !important;
}


path {
    transition: stroke 0.1s ease;
    stroke-width: 1.0px !important;
    stroke: black;
}

path:hover {
    stroke-width: 3px;
    animation: pulseColor 1.4s infinite;
}

@keyframes pulseColor {
    000% { stroke: #000; fill:#F002; }
    050% { stroke: #F00; fill:#0002; }
    100% { stroke: #000; fill:#F002; }
}

text {
    pointer-events: none; /* Предотвращает взаимодействие с текстом при вращении */
}

.textfade {
    animation: fadeOutText 13s ease forwards;
}

@keyframes fadeOutText {
    0% {
        opacity: 1;
    }
    80% { 
        opacity: 0.85;
        filter: blur(0px);
    }
    100% {
        opacity: 0;
        filter: blur(6px);
    }
}
]]></style>
  <script
     id="vkinelrujs"><![CDATA[
    
document.addEventListener('keydown', function(event) {
    const svgRoot = document.documentElement;
    let currentRotation = parseFloat(svgRoot.getAttribute('data-rotation') || '0');
    
    if (event.key === 'a' || event.key === 'A') {
        currentRotation -= 0.5; // Поворот влево
    } else if (event.key === 'd' || event.key === 'D') {
        currentRotation += 0.5; // Поворот вправо
    }
    
    svgRoot.setAttribute('data-rotation', currentRotation);
    svgRoot.style.transform = `rotate(${currentRotation}deg)`;
});

    // Получаем корневой SVG элемент
    const svgRoot = document.documentElement;
    const originalTitle = svgRoot.getAttribute('title') || 'Vkinel.ru';
    
    // Находим все path элементы
    const paths = svgRoot.querySelectorAll('path');

    paths.forEach(path => {
        // Обработчик наведения
        path.addEventListener('mouseover', function() {
            const pathId = this.getAttribute('id') || '(без id)';
            svgRoot.setAttribute('title', pathId);
            document.title = pathId;
        });

        path.addEventListener('mouseout', function() {
            svgRoot.setAttribute('title', originalTitle);
            document.title = originalTitle;
        });

        // Обработчик клика
        path.addEventListener("click", function (event) {
            const pathId = path.id || "(без id)";
            const length = path.getTotalLength();
            let points = [];

            for (let i = 0; i <= length; i += 1) {
                const { x, y } = path.getPointAtLength(i);
                points.push({ x, y });
            }

            if (points.length < 3) {
                alert(`Path ID: ${pathId}\nНе хватает точек для вычисления площади`);
                return;
            }

            console.log(`ID: ${pathId}`);
            console.log(`Количество точек: ${points.length}`);

            let area = 0;
            for (let i = 0; i < points.length - 1; i++) {
                area += (points[i].x * points[i + 1].y) - (points[i + 1].x * points[i].y);
            }
            area = Math.abs(area) / 2;
            area = area / 5.24382628733;

            console.log(`Площадь: ${area.toFixed(2)} м²`);

            // Создаем текстовый элемент
            const svgNS = "http://www.w3.org/2000/svg";
            const text = document.createElementNS(svgNS, "text");

            // Получаем оригинальный цвет stroke из атрибута style
            const style = path.getAttribute('style');
            let pathColor = '#000000'; // Цвет по умолчанию, если stroke не найден
            if (style) {
                const strokeMatch = style.match(/stroke:#[0-9A-Fa-f]{6}/) || style.match(/stroke:#[0-9A-Fa-f]{3}/);
                if (strokeMatch) {
                    pathColor = strokeMatch[0].replace('stroke:', '');
                }
            }
            text.setAttribute("fill", pathColor); // Устанавливаем оригинальный цвет
            text.setAttribute("stroke", "#999D");        // Цвет обводки
            text.setAttribute("stroke-width", "1.5");      // Толщина обводки
            text.setAttribute("paint-order", "stroke");  // Обводка рисуется под заливкой            
            text.setAttribute("class", "textfade");        // Цвет обводки

            // Корректируем координаты клика
            const point = svgRoot.createSVGPoint();
            point.x = event.clientX;
            point.y = event.clientY;
            const ctm = svgRoot.getScreenCTM();
            const svgPoint = point.matrixTransform(ctm.inverse());

            text.setAttribute("x", svgPoint.x);
            text.setAttribute("y", svgPoint.y);
            text.setAttribute("font-size", "8");
            text.textContent = `${pathId}: ${area.toFixed(2)} м²`;

            // Добавляем текст в SVG
            svgRoot.appendChild(text);

            // Удаляем текст через 13 секунд
            setTimeout(() => {
                svgRoot.removeChild(text);
            }, 13000);

            // Оставляем старую анимацию линий
            const svg = document.createElementNS(svgNS, "svg");
            const parentSvg = path.ownerSVGElement;
            svg.setAttribute("width", parentSvg.getAttribute("width"));
            svg.setAttribute("height", parentSvg.getAttribute("height"));
            svg.style.position = "absolute";
            svg.style.top = "0";
            svg.style.left = "0";
            svg.style.pointerEvents = "none";
            parentSvg.appendChild(svg);

            const line = document.createElementNS(svgNS, "line");
            line.setAttribute("stroke-width", "7");
            svg.appendChild(line);

            function getRandomColor() {
                const letters = "0123456789ABCDEF";
                let color = "#";
                for (let i = 0; i < 6; i++) {
                    color += letters[Math.floor(Math.random() * 16)];
                }
                return color;
            }

            function drawLine() {
                let i = 0;
                function moveLine() {
                    if (i < points.length) {
                        line.setAttribute("x1", points[i].x);
                        line.setAttribute("y1", points[i].y);
                        line.setAttribute("x2", i === points.length - 1 ? points[0].x : points[i + 1].x);
                        line.setAttribute("y2", i === points.length - 1 ? points[0].y : points[i + 1].y);
                        line.setAttribute("stroke", getRandomColor());
                        i++;
                        setTimeout(moveLine, 13);
                    } else {
                        setTimeout(() => {
                            parentSvg.removeChild(svg);
                        }, 100);
                    }
                }
                moveLine();
            }

            drawLine();
        });
    });
    
    
]]></script>
</svg>
